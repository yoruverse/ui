---
import { getCollection, render } from "astro:content";
import Layout from "@/components/layouts/layout.astro";
import Prose from "@/components/layouts/prose.astro";
import { Yoruverse } from "@/components/shared/icons";
import {
	Breadcrumb,
	BreadcrumbItem,
	BreadcrumbLink,
	BreadcrumbList,
	BreadcrumbPage,
	BreadcrumbSeparator,
} from "@/components/ui/breadcrumb";
import {
	Sidebar,
	SidebarContent,
	SidebarHeader,
	SidebarNav,
	SidebarNavGroup,
	SidebarNavItem,
	SidebarNavLink,
	SidebarNavList,
} from "@/components/layouts/sidebar";

export async function getStaticPaths() {
	const components = await getCollection("components");

	return components.map((component) => ({
		params: { id: component.id },
		props: { component },
	}));
}

const { component } = Astro.props;
const { Content } = await render(component);

// Get all components for dynamic navigation
const allComponents = await getCollection("components");
---
<Layout
    title={`${component.data.title} Component - Yoruverse UI`}
    description={component.data.description || `Learn how to use the ${component.data.title} component in your React and Astro projects. Includes examples, props, and best practices.`}
    canonical={`https://ui.yoruverse.com/docs/components/${component.id}`}
>
    <Sidebar width="sm" className="fixed h-screen top-5 left-5">
        <SidebarHeader>
            <Yoruverse className="size-8" />
            <h3 class="font-semibold text-primary">Yoruverse UI</h3>
        </SidebarHeader>
        <SidebarContent>
            <SidebarNav>
                <SidebarNavGroup title="Getting Started">
                    <SidebarNavList>
                        <SidebarNavItem>
                            <SidebarNavLink href="/docs/installation">Installation</SidebarNavLink>
                        </SidebarNavItem>
                        <SidebarNavItem>
                            <SidebarNavLink href="/docs/quickstart">Quick Start</SidebarNavLink>
                        </SidebarNavItem>
                        <SidebarNavItem>
                            <SidebarNavLink href="/docs/configuration">Configuration</SidebarNavLink>
                        </SidebarNavItem>
                    </SidebarNavList>
                </SidebarNavGroup>
                <SidebarNavGroup title="Components">
                    <SidebarNavList>
                        {allComponents.map((comp) => (
                            <SidebarNavItem>
                                <SidebarNavLink 
                                    href={`/docs/components/${comp.id}`}
                                    isActive={comp.id === component.id}
                                >
                                    {comp.data.title}
                                </SidebarNavLink>
                            </SidebarNavItem>
                        ))}
                    </SidebarNavList>
                </SidebarNavGroup>
            </SidebarNav>
        </SidebarContent>
    </Sidebar> 
    <Prose>
        <header>
            <Breadcrumb>
                <BreadcrumbList>
                    <BreadcrumbItem>
                        <BreadcrumbLink href="/">Home</BreadcrumbLink>
                    </BreadcrumbItem>
                    <BreadcrumbSeparator />
                    <BreadcrumbItem>
                        <BreadcrumbLink href="/docs">Docs</BreadcrumbLink>
                    </BreadcrumbItem>
                    <BreadcrumbSeparator />
                    <BreadcrumbItem>
                        <BreadcrumbLink href="/docs/components">Components</BreadcrumbLink>
                    </BreadcrumbItem>
                    <BreadcrumbSeparator />
                    <BreadcrumbItem>
                        <BreadcrumbPage>{component.data.title}</BreadcrumbPage>
                    </BreadcrumbItem>
                </BreadcrumbList>
            </Breadcrumb>
            <h1>{component.data.title}</h1>
            <p>{component.data.description}</p>
        </header>
        <Content />
    </Prose>
    <span
        class="fixed z-[-1] size-full top-0 left-0 bg-radial-[75%_75%_at_100%_0%] from-brand-solid/40 to-primary"
    ></span>
</Layout>